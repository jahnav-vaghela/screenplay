/*!-----------------------------------------------------------------------------
 * screenplay â€” A tiny Javascript library to timeline functions
 * v0.0.2 - built 2016-11-27
 * Licensed under the MIT License.
 * http://screenplay.jaysalvat.com/
 * ----------------------------------------------------------------------------
 * Copyright (C) 2016 Jay Salvat
 * http://jaysalvat.com/
 * --------------------------------------------------------------------------*/
!function(t,n){if("function"==typeof define&&define.amd)define(["module","exports"],n);else if("undefined"!=typeof exports)n(module,exports);else{var e={exports:{}};n(e,e.exports),t.screenplayWorking=e.exports}}(this,function(t,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t){var n={animation:{animation:"animationend","-o-animation":"oAnimationEnd","-moz-animation":"animationend","-webkit-animation":"webkitAnimationEnd"},transition:{transition:"transitionend","-o-transition":"oTransitionEnd","-moz-transition":"transitionend","-webkit-transition":"webkitTransitionEnd"}};try{var e=document.createElement("div");for(var i in n[t])if("undefined"!=typeof e.style[i])return n[t][i]}catch(t){return null}}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),r=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,t);var s=n.async,r=void 0===s||s;this.async=r,this.steps=[],this.waits=[],this.index=0,this.loops=1,this.indexes=[],this.markers={},this.playing=!1,this.started=!1,this.animationEnd=i("animation"),this.transitionEnd=i("transition"),this.timer=null,this.events={step:[],play:[],stop:[],loop:[],pause:[],before:[],after:[]},this.finale=function(){}}return s(t,[{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.loops;return this.loops=t,this.playing||(this.playing=!0,this.started?this.next():this._run(),this._trigger("play")),this}},{key:"pause",value:function(){return this.playing&&(this.playing=!1,this._trigger("pause")),this}},{key:"toggle",value:function(){return this.playing?this.pause():this.play()}},{key:"stop",value:function(){return this.loops=1,this.playing=!1,this.finale.call(this),this._trigger("stop")}},{key:"step",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=0;e<n;e++)this.steps.push(t);return this}},{key:"wait",value:function(t){return this.waits[this.steps.length-1]=t,this}},{key:"end",value:function(t){return this.finale=t,this}},{key:"rewind",value:function(){return this.index=0,this._run()}},{key:"marker",value:function(t){return this.markers[t.toString()]=this.steps.length,this}},{key:"goto",value:function(t){return"string"==typeof t&&this.markers[t]&&(this.index=this.markers[t]),"number"==typeof t&&this.steps[t]&&(this.index=this.steps[t]),this._run()}},{key:"loop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return this.loops=t,this}},{key:"previous",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.index=this.index-t,this._run()}},{key:"next",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.index=this.index+t,this._run()}},{key:"same",value:function(){return this._run()}},{key:"on",value:function(t,n){return this.events[t].push(n),this}},{key:"off",value:function(t,n){return n?this.events[t]=this.events[t].filter(function(t){return t!==n}):this.events[t]=[],this}},{key:"_trigger",value:function(t){var n=this;return this.events[t].forEach(function(t){return t.call(n)}),this}},{key:"_run",value:function(){var t=this;if(this.index<0)return void(this.index=0);if(this.index>=this.steps.length&&(this.index=0,this.loops!==-1&&this.loops--,0===this.loops))return this.stop();var n=function(){t.started||(t.started=!0);var n=t.steps[t.index],e=n;"function"==typeof n&&(t.concurrentSteps=1,n.call(t,t._next.bind(t))),Array.isArray(e)&&(t.concurrentSteps=e.length,e.forEach(function(n){n.call(t,t._next.bind(t))}))};return this._trigger("before"),this.async?setTimeout(n):n(),this}},{key:"_next",value:function(t){var n=this,e=0,i=function(){var t=function(){n.index++,n._run(),n._trigger("after")};0===--n.concurrentSteps&&n.playing&&(n.waits[n.index]?setTimeout(function(){t()},n.waits[n.index]):t())};return t?(t=Array.isArray(t)?t:[t],t.forEach(function(s){function r(){s.removeEventListener(o.animationEnd,r,!1),s.removeEventListener(o.transitionEnd,r,!1),s.removeEventListener("ended",r,!1),++e===t.length&&i()}var o=n;"undefined"!=typeof HTMLElement&&s instanceof HTMLElement&&(s.addEventListener(n.animationEnd,r,!1),s.addEventListener(n.transitionEnd,r,!1),"AUDIO"!==s.tagName&&"VIDEO"!==s.tagName||s.addEventListener("ended",r,!1)),"function"==typeof s.then&&s.then(i,i)})):i(),this}}]),t}();n.default=r,t.exports=n.default});
//# sourceMappingURL=maps/screenplay.working.min.js.map
