{"version":3,"sources":["screenplay.js"],"names":["global","factory","define","amd","exports","module","mod","Screenplay","this","_classCallCheck","instance","Constructor","TypeError","getEventName","key","map","animation","-o-animation","-moz-animation","-webkit-animation","transition","-o-transition","-moz-transition","-webkit-transition","div","document","createElement","eventName","style","e","Object","defineProperty","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","protoProps","staticProps","prototype","settings","arguments","undefined","_settings$async","async","_settings$direction","direction","_settings$loops","loops","_settings$loopBackwar","loopBackward","steps","waits","index","loopBuffer","dir","inited","playing","timer1","timer2","markers","animationEnd","transitionEnd","events","init","play","stop","start","loop","pause","before","after","finale","_trigger","_run","next","_break","call","fn","nb","_index","_direction","repeat","push","time","_marker","toString","marker","filter","f","_this","forEach","started","clearTimeout","_this2","go","step","concurrentSteps","_next","bind","Array","isArray","setTimeout","elements","_this3","elementCount","done","element","callback","removeEventListener","self","HTMLElement","addEventListener","tagName","then","default"],"mappings":"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","file":"../screenplay.min.js","sourcesContent":["/*!-----------------------------------------------------------------------------\n * screenplay â€” A tiny Javascript library to timeline functions\n * v0.0.4 - built 2016-12-06\n * Licensed under the MIT License.\n * http://screenplay.jaysalvat.com/\n * ----------------------------------------------------------------------------\n * Copyright (C) 2016 Jay Salvat\n * http://jaysalvat.com/\n * --------------------------------------------------------------------------*/\n(function (global, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define(['module', 'exports'], factory);\n    } else if (typeof exports !== \"undefined\") {\n        factory(module, exports);\n    } else {\n        var mod = {\n            exports: {}\n        };\n        factory(mod, mod.exports);\n        global.Screenplay = mod.exports;\n    }\n})(this, function (module, exports) {\n    'use strict';\n\n    Object.defineProperty(exports, \"__esModule\", {\n        value: true\n    });\n\n    function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n        }\n    }\n\n    var _createClass = function () {\n        function defineProperties(target, props) {\n            for (var i = 0; i < props.length; i++) {\n                var descriptor = props[i];\n                descriptor.enumerable = descriptor.enumerable || false;\n                descriptor.configurable = true;\n                if (\"value\" in descriptor) descriptor.writable = true;\n                Object.defineProperty(target, descriptor.key, descriptor);\n            }\n        }\n\n        return function (Constructor, protoProps, staticProps) {\n            if (protoProps) defineProperties(Constructor.prototype, protoProps);\n            if (staticProps) defineProperties(Constructor, staticProps);\n            return Constructor;\n        };\n    }();\n\n    var Screenplay = function () {\n        function Screenplay() {\n            var settings = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            _classCallCheck(this, Screenplay);\n\n            var _settings$async = settings.async,\n                async = _settings$async === undefined ? false : _settings$async,\n                _settings$direction = settings.direction,\n                direction = _settings$direction === undefined ? 1 : _settings$direction,\n                _settings$loops = settings.loops,\n                loops = _settings$loops === undefined ? 1 : _settings$loops,\n                _settings$loopBackwar = settings.loopBackward,\n                loopBackward = _settings$loopBackwar === undefined ? false : _settings$loopBackwar;\n\n\n            this.steps = [];\n            this.waits = [];\n            this.async = async;\n            this.index = 0;\n            this.loops = loops;\n            this.loopBackward = loopBackward;\n            this.loopBuffer = loops;\n            this.dir = direction;\n            this.inited = false;\n            this.playing = false;\n            this.timer1 = null;\n            this.timer2 = null;\n            this.markers = {};\n            this.animationEnd = getEventName('animation');\n            this.transitionEnd = getEventName('transition');\n            this.events = {\n                'init': [],\n                'play': [],\n                'stop': [],\n                'start': [],\n                'loop': [],\n                'pause': [],\n                'before': [],\n                'after': []\n            };\n            this.finale = function () {};\n        }\n\n        _createClass(Screenplay, [{\n            key: 'init',\n            value: function init() {\n                this.inited = true;\n                this.playing = false;\n\n                if (this.dir === -1) {\n                    this.index = this.steps.length - 1;\n                } else {\n                    this.index = 0;\n                }\n\n                this._trigger('init');\n\n                this._run();\n\n                return this;\n            }\n        }, {\n            key: 'play',\n            value: function play() {\n                var loops = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.loops;\n\n                this.loops = loops;\n                this.loopBuffer = loops;\n\n                if (!this.playing) {\n                    this.playing = true;\n\n                    this._trigger('play');\n\n                    if (this.inited) {\n                        this.next();\n                    } else {\n                        this.inited = true;\n\n                        if (this.dir === -1) {\n                            this.index = this.steps.length - 1;\n                        } else {\n                            this.index = 0;\n                        }\n\n                        this._run();\n                    }\n                }\n\n                return this;\n            }\n        }, {\n            key: 'pause',\n            value: function pause() {\n                if (this.playing) {\n                    this.playing = false;\n\n                    this._break();\n                    this._trigger('pause');\n                }\n\n                return this;\n            }\n        }, {\n            key: 'toggle',\n            value: function toggle() {\n                return this.playing ? this.pause() : this.play();\n            }\n        }, {\n            key: 'stop',\n            value: function stop() {\n                if (this.inited) {\n                    this.playing = false;\n                    this.inited = false;\n\n                    this._break();\n                    this._trigger('stop');\n\n                    this.finale.call(this);\n                }\n\n                return this;\n            }\n        }, {\n            key: 'done',\n            value: function done(fn) {\n                this.finale = fn;\n\n                return this;\n            }\n        }, {\n            key: 'previous',\n            value: function previous() {\n                var nb = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n\n                if (this.inited) {\n                    this.index = this.index - nb * this.dir;\n                    this._run();\n                }\n\n                return this;\n            }\n        }, {\n            key: 'next',\n            value: function next() {\n                var nb = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n\n                if (this.inited) {\n                    this.index = this.index + nb * this.dir;\n                    this._run();\n                }\n\n                return this;\n            }\n        }, {\n            key: 'same',\n            value: function same() {\n                this._run();\n\n                return this;\n            }\n        }, {\n            key: 'rewind',\n            value: function rewind() {\n                this.index = this.dir === -1 ? this.steps.length - 1 : 0;\n\n                return this._run();\n            }\n        }, {\n            key: 'loop',\n            value: function loop() {\n                var loops = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : -1;\n                var loopBackward = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.loopBackward;\n\n                this.loops = loops;\n                this.loopBackward = loopBackward;\n                this.loopBuffer = loops;\n\n                return this;\n            }\n        }, {\n            key: 'index',\n            value: function index(_index) {\n                if (_index === undefined) {\n                    return this.index;\n                }\n                this.index = _index;\n\n                return this;\n            }\n        }, {\n            key: 'direction',\n            value: function direction(_direction) {\n                if (_direction === undefined) {\n                    return this.dir;\n                }\n                this.dir = _direction;\n\n                return this;\n            }\n        }, {\n            key: 'reverse',\n            value: function reverse() {\n                return this.direction(this.dir * -1);\n            }\n        }, {\n            key: 'step',\n            value: function step(fn) {\n                var repeat = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n\n                for (var i = 0; i < repeat; i++) {\n                    this.steps.push(fn);\n                }\n\n                return this;\n            }\n        }, {\n            key: 'wait',\n            value: function wait(time) {\n                this.waits[this.steps.length - 1] = time;\n\n                if (time) {\n                    this.async = true;\n                }\n\n                return this;\n            }\n        }, {\n            key: 'marker',\n            value: function marker(_marker) {\n                this.markers[_marker.toString()] = this.steps.length;\n\n                return this;\n            }\n        }, {\n            key: 'goto',\n            value: function goto(marker) {\n                if (typeof marker === 'string') {\n                    if (this.markers[marker]) {\n                        this.index = this.markers[marker];\n                    }\n                }\n\n                if (typeof marker === 'number') {\n                    if (this.steps[marker]) {\n                        this.index = this.steps[marker];\n                    }\n                }\n\n                return this._run();\n            }\n        }, {\n            key: 'on',\n            value: function on(key, fn) {\n                this.events[key].push(fn);\n\n                return this;\n            }\n        }, {\n            key: 'off',\n            value: function off(key, fn) {\n                if (fn) {\n                    this.events[key] = this.events[key].filter(function (f) {\n                        return f !== fn;\n                    });\n                } else {\n                    this.events[key] = [];\n                }\n\n                return this;\n            }\n        }, {\n            key: '_trigger',\n            value: function _trigger(key) {\n                var _this = this;\n\n                this.events[key].forEach(function (fn) {\n                    return fn.call(_this);\n                });\n\n                return this;\n            }\n        }, {\n            key: '_break',\n            value: function _break() {\n                if (this.started) {\n                    this.started = false;\n                    this._trigger('after');\n                }\n\n                clearTimeout(this.timer1);\n                clearTimeout(this.timer2);\n            }\n        }, {\n            key: '_run',\n            value: function _run() {\n                var _this2 = this;\n\n                if (this.index < 0) {\n                    if (this.loops !== -1) {\n                        if (this.dir === -1 || this.dir === 1 && this.loopBackward) {\n                            this.index = this.steps.length - 1;\n                            this.loops = this.loops + this.dir;\n                        } else {\n                            return this.stop();\n                        }\n                    } else {\n                        this.index = this.steps.length - 1;\n                    }\n\n                    if (this.loops === 0 || this.loops > this.loopBuffer) {\n                        return this.stop();\n                    } else {\n                        this._trigger('loop');\n                    }\n                }\n\n                if (this.index >= this.steps.length) {\n                    if (this.loops !== -1) {\n                        if (this.dir === 1 || this.dir === -1 && this.loopBackward) {\n                            this.index = 0;\n                            this.loops = this.loops - this.dir;\n                        } else {\n                            return this.stop();\n                        }\n                    } else {\n                        this.index = 0;\n                    }\n\n                    if (this.loops === 0 || this.loops > this.loopBuffer) {\n                        return this.stop();\n                    } else {\n                        this._trigger('loop');\n                    }\n                }\n\n                var go = function go() {\n                    var step = _this2.steps[_this2.index],\n                        steps = step;\n\n                    _this2.started = true;\n                    _this2._trigger('before');\n\n                    if (typeof step === 'function') {\n                        _this2.concurrentSteps = 1;\n\n                        step.call(_this2, _this2._next.bind(_this2));\n                    }\n\n                    if (Array.isArray(steps)) {\n                        _this2.concurrentSteps = steps.length;\n\n                        steps.forEach(function (step) {\n                            step.call(_this2, _this2._next.bind(_this2));\n                        });\n                    }\n                };\n\n                if (this.async) {\n                    clearTimeout(this.timer1);\n\n                    this.timer1 = setTimeout(go);\n                } else {\n                    go();\n                }\n\n                return this;\n            }\n        }, {\n            key: '_next',\n            value: function _next(elements) {\n                var _this3 = this;\n\n                var elementCount = 0;\n\n                if (!this.playing) {\n                    this._trigger('after');\n                    return;\n                }\n\n                var go = function go() {\n                    if (_this3.started) {\n                        _this3.started = false;\n                        _this3._trigger('after');\n                    }\n\n                    _this3.index = _this3.index + _this3.dir;\n                    _this3._run();\n                };\n\n                var done = function done() {\n                    if (--_this3.concurrentSteps <= 0) {\n                        if (_this3.async) {\n                            clearTimeout(_this3.timer2);\n\n                            _this3.timer2 = setTimeout(go, _this3.waits[_this3.index]);\n                        } else {\n                            go();\n                        }\n                    }\n                };\n\n                if (elements) {\n                    elements = Array.isArray(elements) ? elements : [elements];\n\n                    elements.forEach(function (element) {\n                        var self = _this3;\n\n                        function callback() {\n                            element.removeEventListener(self.animationEnd, callback, false);\n                            element.removeEventListener(self.transitionEnd, callback, false);\n                            element.removeEventListener(\"ended\", callback, false);\n\n                            if (++elementCount === elements.length) {\n                                done();\n                            }\n                        }\n\n                        if (typeof HTMLElement !== 'undefined' && element instanceof HTMLElement) {\n                            element.addEventListener(_this3.animationEnd, callback, false);\n                            element.addEventListener(_this3.transitionEnd, callback, false);\n\n                            if (element.tagName === 'AUDIO' || element.tagName === 'VIDEO') {\n                                element.addEventListener(\"ended\", callback, false);\n                            }\n                        }\n\n                        if (typeof element.then === 'function') {\n                            element.then(done, done);\n                        }\n                    });\n                } else {\n                    done();\n                }\n\n                return this;\n            }\n        }]);\n\n        return Screenplay;\n    }();\n\n    function getEventName(key) {\n        var map = {\n            animation: {\n                'animation': 'animationend',\n                '-o-animation': 'oAnimationEnd',\n                '-moz-animation': 'animationend',\n                '-webkit-animation': 'webkitAnimationEnd'\n            },\n            transition: {\n                'transition': 'transitionend',\n                '-o-transition': 'oTransitionEnd',\n                '-moz-transition': 'transitionend',\n                '-webkit-transition': 'webkitTransitionEnd'\n            }\n        };\n\n        try {\n            var div = document.createElement('div');\n\n            for (var eventName in map[key]) {\n                if (typeof div.style[eventName] !== 'undefined') {\n                    return map[key][eventName];\n                }\n            }\n        } catch (e) {\n            return null;\n        }\n    }\n\n    exports.default = Screenplay;\n    module.exports = exports['default'];\n});\n//# sourceMappingURL=maps/screenplay.js.map\n"]}