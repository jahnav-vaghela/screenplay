/*!-----------------------------------------------------------------------------
 * screenplay â€” A tiny Javascript library to timeline functions
 * v0.0.1 - built 2016-11-21
 * Licensed under the MIT License.
 * http://screenplay.jaysalvat.com/
 * ----------------------------------------------------------------------------
 * Copyright (C) 2016 Jay Salvat
 * http://jaysalvat.com/
 * --------------------------------------------------------------------------*/
!function(t,n){if("function"==typeof define&&define.amd)define(["module"],n);else if("undefined"!=typeof exports)n(module);else{var i={exports:{}};n(i),t.screenplayBk=i.exports}}(this,function(t){"use strict";function n(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(n,i,e){return i&&t(n.prototype,i),e&&t(n,e),n}}();!function(n,i){"undefined"!=typeof t&&t.exports?t.exports=i():"function"==typeof define&&define.amd?define([],i):n.Screenplay=i()}(void 0,function(){function t(t){var n={animation:{animation:"animationend","-o-animation":"oAnimationEnd","-moz-animation":"animationend","-webkit-animation":"webkitAnimationEnd"},transition:{transition:"transitionend","-o-transition":"oTransitionEnd","-moz-transition":"transitionend","-webkit-transition":"webkitTransitionEnd"}};try{var i=document.createElement("div");for(var e in n[t])if("undefined"!=typeof i.style[e])return n[t][e]}catch(t){return null}}var e=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e);var s=i.async,r=void 0===s||s;this.async=r,this.steps=[],this.index=0,this.loops=1,this.indexes=[],this.markers={},this.playing=!1,this.animationEnd=t("animation"),this.transitionEnd=t("transition"),this.timer=null,this.events={step:[],play:[],stop:[],loop:[],pause:[],before:[],after:[]},this.finale=function(){}}return i(e,[{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.loops;return this.loops=t,this.playing=!0,this.run(),this.trigger("play")}},{key:"pause",value:function(){return this.playing=!1,this.run(),this.trigger("pause")}},{key:"toggle",value:function(){return this.playing?this.pause():this.play()}},{key:"stop",value:function(){return this.loops=1,this.playing=!1,this.finale.call(this),this.trigger("stop")}},{key:"step",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=0;i<n;i++)this.steps.push(t),this.indexes.push(this.steps.length-1);return this}},{key:"wait",value:function(t){return this.steps.push(function(n){clearTimeout(this.timer),this.timer=setTimeout(function(){n()},t)}),this}},{key:"repeat",value:function(t){var n=this.steps[this.steps.length-1];return this.step(n,t)}},{key:"end",value:function(t){return this.finale=t,this}},{key:"rewind",value:function(){return this.index=0,this.playing=!0,this.run(),this}},{key:"marker",value:function(t){return this.markers[t.toString()]=this.steps.length,this}},{key:"goto",value:function(t){return"string"==typeof t&&this.markers[t]&&(this.index=this.markers[t],this.run()),"number"==typeof t&&this.indexes[t]&&(this.index=this.indexes[t],this.run()),this}},{key:"on",value:function(t,n){return this.events[t].push(n),this}},{key:"off",value:function(t,n){return n?this.events[t]=this.events[t].filter(function(t){return t!==n}):this.events[t]=[],this}},{key:"trigger",value:function(t){var n=this;return this.events[t].forEach(function(t){return t.call(n)}),this}},{key:"loop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return this.loops=t,this}},{key:"previous",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=this._reverseIndex(this.index-t,!0);return n&&(this.index=n,this.run()),this}},{key:"next",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=this._reverseIndex(this.index+t);return n&&(this.index=n,this.run()),this}},{key:"same",value:function(){return this.index-=1,this.run(),this}},{key:"run",value:function(){var t=this;if(this.playing){if(this.index<0&&(this.index=0),this.index>=this.steps.length&&(this.index=0,this.loops!==-1&&this.loops--,0===this.loops))return this.stop();var n=function(){var n=t.steps[t.index],i=n;"function"==typeof n&&(t.concurrentSteps=1,n.call(t,t._next.bind(t))),Array.isArray(i)&&(t.concurrentSteps=i.length,i.forEach(function(n){n.call(t,t._next.bind(t))}))};return this.trigger("before"),this.async?setTimeout(n):n(),this}}},{key:"_next",value:function(t){var n=this,i=0,e=function(){0===--n.concurrentSteps&&(n.index++,n.run(),n.trigger("after"))};return t?(t=Array.isArray(t)?t:[t],t.forEach(function(s){function r(){s.removeEventListener(o.animationEnd,r,!1),s.removeEventListener(o.transitionEnd,r,!1),++i===t.length&&e()}var o=n;s.addEventListener(n.animationEnd,r,!1),s.addEventListener(n.transitionEnd,r,!1)})):e(),this}},{key:"_reverseIndex",value:function(t,n){for(var i=void 0,e=0;e<this.indexes.length;e++){if(n&&this.indexes[e]>=t||!n&&this.indexes[e]>t)return i;i=this.indexes[e]}return 0}}]),e}();return e})});
//# sourceMappingURL=maps/screenplay.bk.min.js.map
