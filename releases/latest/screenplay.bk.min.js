/*!-----------------------------------------------------------------------------
 * screenplay â€” A tiny Javascript library to timeline functions
 * v0.0.1 - built 2016-11-19
 * Licensed under the MIT License.
 * http://screenplay.jaysalvat.com/
 * ----------------------------------------------------------------------------
 * Copyright (C) 2016 Jay Salvat
 * http://jaysalvat.com/
 * --------------------------------------------------------------------------*/
!function(t,i){"use strict";"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof define&&define.amd?define([],i):t.Screenplay=i()}(this,function(){"use strict";function t(t){var i,n={animation:{animation:"animationend","-o-animation":"oAnimationEnd","-moz-animation":"animationend","-webkit-animation":"webkitAnimationEnd"},transition:{transition:"transitionend","-o-transition":"oTransitionEnd","-moz-transition":"transitionend","-webkit-transition":"webkitTransitionEnd"}};try{i=document.createElement("div")}catch(t){return null}for(var e in n[t])if("undefined"!=typeof i.style[e])return n[t][e];return null}var i=function i(n){return this instanceof i?(this.steps=[],this.indexes=[],this.markers={},this.index=0,this.loops=1,this.playing=!1,this.animationEnd=t("animation"),this.transitionEnd=t("transition"),this.events={step:[],play:[],pause:[],stop:[],loop:[],before:[],after:[]},this.timer=null,this.finale=function(){},this):new i(n)};return i.prototype={play:function(t){return this.loops=t?t:this.loops,this.playing=!0,this.run(),this.trigger("play")},pause:function(){return this.playing=!1,this.run(),this.trigger("pause")},toggle:function(){return this.playing?this.pause():this.play()},stop:function(){return this.loops=1,this.playing=!1,this.finale.call(this),this.trigger("stop")},step:function(t,i){i=i||1;for(var n=0;n<i;n++)this.steps.push(t),this.indexes.push(this.steps.length-1);return this},wait:function(t){return this.steps.push(function(i){clearTimeout(this.timer),this.timer=setTimeout(function(){i()},t)}),this},repeat:function(t){var i=this.steps[this.steps.length-1];return this.step(i,t)},end:function(t){return this.finale=t,this},rewind:function(){return this.index=0,this.playing=!0,this.run(),this},marker:function(t){return this.markers[t.toString()]=this.steps.length,this},goto:function(t){return"string"==typeof t&&this.markers[t]&&(this.index=this.markers[t],this.run()),"number"==typeof t&&this.indexes[t]&&(this.index=this.indexes[t],this.run()),this},on:function(t,i){return this.events[t].push(i),this},off:function(t,i){return i?this.events[t]=this.events[t].filter(function(t){return t!==i}):this.events[t]=[],this},trigger:function(t){var i=this;return this.events[t].forEach(function(t){t.call(i)}),this},loop:function(t){return this.loops=void 0!==t?t:-1,this},previous:function(t){var i=this._reverseIndex(this.index-(t||1),!0);return i&&(this.index=i,this.run()),this},next:function(t){var i=this._reverseIndex(this.index+(t||1));return i&&(this.index=i,this.run()),this},same:function(){return this.index-=1,this.run(),this},run:function(){var t;if(this.playing){if(this.index<0&&(this.index=0),this.index>=this.steps.length&&(this.index=0,this.loops!==-1&&this.loops--,0===this.loops))return this.stop();if(this.trigger("before"),t=this.steps[this.index],"function"==typeof t&&(this.concurrentSteps=1,t.call(this,this._next.bind(this))),Array.isArray(t)){var i=t;this.concurrentSteps=i.length,i.forEach(function(t){t.call(this,this._next.bind(this))})}return this}},_next:function(t){var i=this,n=0,e=function(){i.concurrentSteps--,0===i.concurrentSteps&&(console.log("next"),i.index++,i.run(),i.trigger("after"))};return t?(t=Array.isArray(t)?t:[t],t.forEach(function(s){var r=function r(){s.removeEventListener(i.animationEnd,r),s.removeEventListener(i.transitionEnd,r),n++===t.length-1&&e()};s.addEventListener(i.transitionEnd,r,!1),s.addEventListener(i.animationEnd,r,!1)})):e(),this},_reverseIndex:function(t,i){for(var n,e=0;e<this.indexes.length;e++){if(i&&this.indexes[e]>=t||!i&&this.indexes[e]>t)return n;n=this.indexes[e]}return 0}},i});
//# sourceMappingURL=maps/screenplay.bk.min.js.map
