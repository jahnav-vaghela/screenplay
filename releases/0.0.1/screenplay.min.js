/*!-----------------------------------------------------------------------------
 * screenplay â€” A tiny Javascript library to timeline functions
 * v0.0.1 - built 2016-11-19
 * Licensed under the MIT License.
 * http://screenplay.jaysalvat.com/
 * ----------------------------------------------------------------------------
 * Copyright (C) 2016 Jay Salvat
 * http://jaysalvat.com/
 * --------------------------------------------------------------------------*/
function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},_createClass=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}();!function(t,n){"use strict";"undefined"!=typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define([],n):t.Screenplay=n()}(this,function(){"use strict";function t(t){var n={animation:{animation:"animationend","-o-animation":"oAnimationEnd","-moz-animation":"animationend","-webkit-animation":"webkitAnimationEnd"},transition:{transition:"transitionend","-o-transition":"oTransitionEnd","-moz-transition":"transitionend","-webkit-transition":"webkitTransitionEnd"}};try{var e=document.createElement("div");for(var i in n[t])if("undefined"!=typeof e.style[i])return n[t][i]}catch(t){return null}}var n=function(){function n(e){_classCallCheck(this,n),e=_extends({},{async:!0},e),this.async=e.async,this.steps=[],this.indexes=[],this.markers={},this.index=0,this.loops=1,this.playing=!1,this.animationEnd=t("animation"),this.transitionEnd=t("transition"),this.events={step:[],play:[],pause:[],stop:[],loop:[],before:[],after:[]},this.timer=null,this.finale=function(){}}return _createClass(n,[{key:"play",value:function(t){return this.loops=t?t:this.loops,this.playing=!0,this.run(),this.trigger("play")}},{key:"pause",value:function(){return this.playing=!1,this.run(),this.trigger("pause")}},{key:"toggle",value:function(){return this.playing?this.pause():this.play()}},{key:"stop",value:function(){return this.loops=1,this.playing=!1,this.finale.call(this),this.trigger("stop")}},{key:"step",value:function(t,n){n=n||1;for(var e=0;e<n;e++)this.steps.push(t),this.indexes.push(this.steps.length-1);return this}},{key:"wait",value:function(t){return this.steps.push(function(n){clearTimeout(this.timer),this.timer=setTimeout(function(){n()},t)}),this}},{key:"repeat",value:function(t){var n=this.steps[this.steps.length-1];return this.step(n,t)}},{key:"end",value:function(t){return this.finale=t,this}},{key:"rewind",value:function(){return this.index=0,this.playing=!0,this.run(),this}},{key:"marker",value:function(t){return this.markers[t.toString()]=this.steps.length,this}},{key:"goto",value:function(t){return"string"==typeof t&&this.markers[t]&&(this.index=this.markers[t],this.run()),"number"==typeof t&&this.indexes[t]&&(this.index=this.indexes[t],this.run()),this}},{key:"on",value:function(t,n){return this.events[t].push(n),this}},{key:"off",value:function(t,n){return n?this.events[t]=this.events[t].filter(function(t){return t!==n}):this.events[t]=[],this}},{key:"trigger",value:function(t){var n=this;return this.events[t].forEach(function(t){t.call(n)}),this}},{key:"loop",value:function(t){return this.loops=void 0!==t?t:-1,this}},{key:"previous",value:function(t){var n=this._reverseIndex(this.index-(t||1),!0);return n&&(this.index=n,this.run()),this}},{key:"next",value:function(t){var n=this._reverseIndex(this.index+(t||1));return n&&(this.index=n,this.run()),this}},{key:"same",value:function(){return this.index-=1,this.run(),this}},{key:"run",value:function(){var t=this;if(this.playing){if(this.index<0&&(this.index=0),this.index>=this.steps.length&&(this.index=0,this.loops!==-1&&this.loops--,0===this.loops))return this.stop();var n=function(){var n=t.steps[t.index],e=n;"function"==typeof n&&(t.concurrentSteps=1,n.call(t,t._next.bind(t))),Array.isArray(e)&&(t.concurrentSteps=e.length,e.forEach(function(n){n.call(t,t._next.bind(t))}))};return this.trigger("before"),this.async?setTimeout(n):n(),this}}},{key:"_next",value:function(t){var n=this,e=0,i=function(){0===--n.concurrentSteps&&(n.index++,n.run(),n.trigger("after"))};return t?(t=Array.isArray(t)?t:[t],t.forEach(function(s){var r=function r(){s.removeEventListener(n.animationEnd,r),s.removeEventListener(n.transitionEnd,r),++e===t.length&&i()};s.addEventListener(n.transitionEnd,r,!1),s.addEventListener(n.animationEnd,r,!1)})):i(),this}},{key:"_reverseIndex",value:function(t,n){for(var e=void 0,i=0;i<this.indexes.length;i++){if(n&&this.indexes[i]>=t||!n&&this.indexes[i]>t)return e;e=this.indexes[i]}return 0}}]),n}();return n});
//# sourceMappingURL=maps/screenplay.min.js.map
