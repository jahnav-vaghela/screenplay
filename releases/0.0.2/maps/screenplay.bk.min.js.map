{"version":3,"sources":["screenplay.bk.js"],"names":["global","factory","define","amd","exports","module","mod","screenplayBk","this","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","context","Screenplay","undefined","getEventName","map","animation","-o-animation","-moz-animation","-webkit-animation","transition","-o-transition","-moz-transition","-webkit-transition","div","document","createElement","eventName","style","e","settings","arguments","_settings$async","async","steps","index","loops","indexes","markers","playing","animationEnd","transitionEnd","timer","events","step","play","stop","loop","pause","before","after","finale","value","run","trigger","call","fn","repeat","push","time","next","clearTimeout","setTimeout","_repeat","last","_marker","toString","marker","filter","f","_this","forEach","nb","_reverseIndex","_this2","go","concurrentSteps","_next","bind","Array","isArray","doms","_this3","domCount","done","dom","callback","removeEventListener","self","addEventListener","previous","buffer"],"mappings":"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","file":"../screenplay.bk.min.js","sourcesContent":["/*!-----------------------------------------------------------------------------\n * screenplay â€” A tiny Javascript library to timeline functions\n * v0.0.2 - built 2016-11-21\n * Licensed under the MIT License.\n * http://screenplay.jaysalvat.com/\n * ----------------------------------------------------------------------------\n * Copyright (C) 2016 Jay Salvat\n * http://jaysalvat.com/\n * --------------------------------------------------------------------------*/\n(function (global, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define(['module'], factory);\n    } else if (typeof exports !== \"undefined\") {\n        factory(module);\n    } else {\n        var mod = {\n            exports: {}\n        };\n        factory(mod);\n        global.screenplayBk = mod.exports;\n    }\n})(this, function (module) {\n    'use strict';\n\n    function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n        }\n    }\n\n    var _createClass = function () {\n        function defineProperties(target, props) {\n            for (var i = 0; i < props.length; i++) {\n                var descriptor = props[i];\n                descriptor.enumerable = descriptor.enumerable || false;\n                descriptor.configurable = true;\n                if (\"value\" in descriptor) descriptor.writable = true;\n                Object.defineProperty(target, descriptor.key, descriptor);\n            }\n        }\n\n        return function (Constructor, protoProps, staticProps) {\n            if (protoProps) defineProperties(Constructor.prototype, protoProps);\n            if (staticProps) defineProperties(Constructor, staticProps);\n            return Constructor;\n        };\n    }();\n\n    /* global define */\n\n    (function (context, factory) {\n        'use strict';\n\n        if (typeof module !== 'undefined' && module.exports) {\n            module.exports = factory();\n        } else if (typeof define === 'function' && define.amd) {\n            define([], factory);\n        } else {\n            context.Screenplay = factory();\n        }\n    })(undefined, function () {\n        'use strict';\n\n        var Screenplay = function () {\n            function Screenplay() {\n                var settings = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n                _classCallCheck(this, Screenplay);\n\n                var _settings$async = settings.async,\n                    async = _settings$async === undefined ? true : _settings$async;\n\n\n                this.async = async;\n                this.steps = [];\n                this.index = 0;\n                this.loops = 1;\n                this.indexes = [];\n                this.markers = {};\n                this.playing = false;\n                this.animationEnd = getEventName('animation');\n                this.transitionEnd = getEventName('transition');\n                this.timer = null;\n                this.events = {\n                    'step': [],\n                    'play': [],\n                    'stop': [],\n                    'loop': [],\n                    'pause': [],\n                    'before': [],\n                    'after': []\n                };\n                this.finale = function () {};\n            }\n\n            _createClass(Screenplay, [{\n                key: 'play',\n                value: function play() {\n                    var loops = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.loops;\n\n                    this.loops = loops;\n                    this.playing = true;\n                    this.run();\n\n                    return this.trigger('play');\n                }\n            }, {\n                key: 'pause',\n                value: function pause() {\n                    this.playing = false;\n                    this.run();\n\n                    return this.trigger('pause');\n                }\n            }, {\n                key: 'toggle',\n                value: function toggle() {\n                    return this.playing ? this.pause() : this.play();\n                }\n            }, {\n                key: 'stop',\n                value: function stop() {\n                    this.loops = 1;\n                    this.playing = false;\n                    this.finale.call(this);\n\n                    return this.trigger('stop');\n                }\n            }, {\n                key: 'step',\n                value: function step(fn) {\n                    var repeat = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n\n                    for (var i = 0; i < repeat; i++) {\n                        this.steps.push(fn);\n                        this.indexes.push(this.steps.length - 1);\n                    }\n\n                    return this;\n                }\n            }, {\n                key: 'wait',\n                value: function wait(time) {\n                    this.steps.push(function (next) {\n                        clearTimeout(this.timer);\n\n                        this.timer = setTimeout(function () {\n                            next();\n                        }, time);\n                    });\n\n                    return this;\n                }\n            }, {\n                key: 'repeat',\n                value: function repeat(_repeat) {\n                    var last = this.steps[this.steps.length - 1];\n\n                    return this.step(last, _repeat);\n                }\n            }, {\n                key: 'end',\n                value: function end(fn) {\n                    this.finale = fn;\n\n                    return this;\n                }\n            }, {\n                key: 'rewind',\n                value: function rewind() {\n                    this.index = 0;\n                    this.playing = true;\n                    this.run();\n\n                    return this;\n                }\n            }, {\n                key: 'marker',\n                value: function marker(_marker) {\n                    this.markers[_marker.toString()] = this.steps.length;\n\n                    return this;\n                }\n            }, {\n                key: 'goto',\n                value: function goto(marker) {\n                    if (typeof marker === 'string') {\n                        if (this.markers[marker]) {\n                            this.index = this.markers[marker];\n                            this.run();\n                        }\n                    }\n\n                    if (typeof marker === 'number') {\n                        if (this.indexes[marker]) {\n                            this.index = this.indexes[marker];\n                            this.run();\n                        }\n                    }\n\n                    return this;\n                }\n            }, {\n                key: 'on',\n                value: function on(key, fn) {\n                    this.events[key].push(fn);\n\n                    return this;\n                }\n            }, {\n                key: 'off',\n                value: function off(key, fn) {\n                    if (fn) {\n                        this.events[key] = this.events[key].filter(function (f) {\n                            return f !== fn;\n                        });\n                    } else {\n                        this.events[key] = [];\n                    }\n\n                    return this;\n                }\n            }, {\n                key: 'trigger',\n                value: function trigger(key) {\n                    var _this = this;\n\n                    this.events[key].forEach(function (fn) {\n                        return fn.call(_this);\n                    });\n\n                    return this;\n                }\n            }, {\n                key: 'loop',\n                value: function loop() {\n                    var loops = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : -1;\n\n                    this.loops = loops;\n\n                    return this;\n                }\n            }, {\n                key: 'previous',\n                value: function previous() {\n                    var nb = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n\n                    var index = this._reverseIndex(this.index - nb, true);\n\n                    if (index) {\n                        this.index = index;\n                        this.run();\n                    }\n\n                    return this;\n                }\n            }, {\n                key: 'next',\n                value: function next() {\n                    var nb = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n\n                    var index = this._reverseIndex(this.index + nb);\n\n                    if (index) {\n                        this.index = index;\n                        this.run();\n                    }\n\n                    return this;\n                }\n            }, {\n                key: 'same',\n                value: function same() {\n                    this.index -= 1;\n                    this.run();\n\n                    return this;\n                }\n            }, {\n                key: 'run',\n                value: function run() {\n                    var _this2 = this;\n\n                    if (!this.playing) {\n                        return;\n                    }\n\n                    if (this.index < 0) {\n                        this.index = 0;\n                    }\n\n                    if (this.index >= this.steps.length) {\n                        this.index = 0;\n\n                        if (this.loops !== -1) {\n                            this.loops--;\n                        }\n\n                        if (this.loops === 0) {\n                            return this.stop();\n                        }\n                    }\n\n                    var go = function go() {\n                        var step = _this2.steps[_this2.index],\n                            steps = step;\n\n                        if (typeof step === 'function') {\n                            _this2.concurrentSteps = 1;\n\n                            step.call(_this2, _this2._next.bind(_this2));\n                        }\n\n                        if (Array.isArray(steps)) {\n                            _this2.concurrentSteps = steps.length;\n\n                            steps.forEach(function (step) {\n                                step.call(_this2, _this2._next.bind(_this2));\n                            });\n                        }\n                    };\n\n                    this.trigger('before');\n\n                    if (this.async) {\n                        setTimeout(go);\n                    } else {\n                        go();\n                    }\n\n                    return this;\n                }\n            }, {\n                key: '_next',\n                value: function _next(doms) {\n                    var _this3 = this;\n\n                    var domCount = 0;\n\n                    var done = function done() {\n                        if (--_this3.concurrentSteps === 0) {\n                            _this3.index++;\n                            _this3.run();\n                            _this3.trigger('after');\n                        }\n                    };\n\n                    if (doms) {\n                        doms = Array.isArray(doms) ? doms : [doms];\n\n                        doms.forEach(function (dom) {\n                            var self = _this3;\n\n                            function callback() {\n                                dom.removeEventListener(self.animationEnd, callback, false);\n                                dom.removeEventListener(self.transitionEnd, callback, false);\n\n                                if (++domCount === doms.length) {\n                                    done();\n                                }\n                            }\n\n                            dom.addEventListener(_this3.animationEnd, callback, false);\n                            dom.addEventListener(_this3.transitionEnd, callback, false);\n                        });\n                    } else {\n                        done();\n                    }\n\n                    return this;\n                }\n            }, {\n                key: '_reverseIndex',\n                value: function _reverseIndex(index, previous) {\n                    var buffer = void 0;\n\n                    for (var i = 0; i < this.indexes.length; i++) {\n                        if (previous && this.indexes[i] >= index || !previous && this.indexes[i] > index) {\n                            return buffer;\n                        }\n                        buffer = this.indexes[i];\n                    }\n\n                    return 0;\n                }\n            }]);\n\n            return Screenplay;\n        }();\n\n        function getEventName(key) {\n            var map = {\n                animation: {\n                    'animation': 'animationend',\n                    '-o-animation': 'oAnimationEnd',\n                    '-moz-animation': 'animationend',\n                    '-webkit-animation': 'webkitAnimationEnd'\n                },\n                transition: {\n                    'transition': 'transitionend',\n                    '-o-transition': 'oTransitionEnd',\n                    '-moz-transition': 'transitionend',\n                    '-webkit-transition': 'webkitTransitionEnd'\n                }\n            };\n\n            try {\n                var div = document.createElement('div');\n\n                for (var eventName in map[key]) {\n                    if (typeof div.style[eventName] !== 'undefined') {\n                        return map[key][eventName];\n                    }\n                }\n            } catch (e) {\n                return null;\n            }\n        }\n\n        return Screenplay;\n    });\n});\n//# sourceMappingURL=maps/screenplay.bk.js.map\n"]}